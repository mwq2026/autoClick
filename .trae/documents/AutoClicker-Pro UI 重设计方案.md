## 1. 现状功能梳理（基于现有实现）
- **入口与全局结构**：单窗口 ImGui 工具 + 全局热键 Ctrl+F12 停止运行（录制/回放/屏蔽输入统一终止）。现有 UI 仅分“简单模式/高级模式(Lua)”两页签式切换，见 [App.cpp](file:///d:/MyCode/autoClick/src/app/App.cpp)。
- **简单模式（录制/回放）**：
  - .trc 路径输入、文件选择/另存为
  - 录制：开始/停止，保存 .trc
  - 回放：加载 .trc、开始/停止回放
  - 参数：回放倍速(0.5–10)、屏蔽系统输入（BlockInput，可能需管理员）
  - 状态：事件数、总时长、回放进度条
- **高级模式（Lua）**：
  - .lua 路径输入、文件选择
  - 打开到编辑器/保存/运行脚本
  - 从 .trc 导出到 .lua（目前主要导出 move + wait_ms）
  - 仅在界面显示 Lua 运行错误文本，见 [App.cpp](file:///d:/MyCode/autoClick/src/app/App.cpp)。
- **录制悬浮提示**：左上角透明悬浮窗显示 Recording… + 时长，见 [OverlayWindow.cpp](file:///d:/MyCode/autoClick/src/core/OverlayWindow.cpp)。
- **自动化能力边界**：
  - 录制：低级钩子捕获鼠标/键盘与微秒级时间差，见 [Hooks.cpp](file:///d:/MyCode/autoClick/src/core/Hooks.cpp)。
  - 回放：SendInput 注入 + 高精度等待，见 [Replayer.cpp](file:///d:/MyCode/autoClick/src/core/Replayer.cpp) 与 [HighPrecisionWait.h](file:///d:/MyCode/autoClick/src/core/HighPrecisionWait.h)。
  - Lua API：playback/human_move/human_click/human_scroll/set_speed/wait_ms，见 [LuaEngine.cpp](file:///d:/MyCode/autoClick/src/core/LuaEngine.cpp)。

## 2. 用户研究（全面用户研究 + 需求洞察）
- **研究目标**：明确“谁在用、为何用、频率/场景、风险约束（误触/屏蔽输入）、可用性瓶颈、学习成本（脚本 vs 录制）”。
- **方法组合**：
  - 半结构化访谈（8–12 人）：不同熟练度、不同使用场景。
  - 问卷（100+）：功能重要度、痛点排序、学习意愿、错误成本。
  - 可用性走查（5 人/轮，2–3 轮）：完成关键任务的时间/错误率。
  - 竞品分析：宏录制类、脚本自动化类、测试回放类工具（信息架构、引导、风险控制、无障碍）。
- **需要收集的数据**：
  - 关键任务：录制-保存-回放；加载任务-参数调整-回放；脚本编辑-运行-调试；导出/转换。
  - 关键指标：完成率、平均用时、严重错误（无法停止、误点导致损失）、学习曲线。

## 3. 用户画像与使用场景（可直接落到界面）
- **P1：轻量用户（“快速完成重复动作”）**
  - 目标：3 分钟内录制并成功回放
  - 痛点：不理解 .trc、害怕屏蔽输入、找不到停止、缺少引导
- **P2：高频办公用户（“稳定执行+可复用”）**
  - 目标：管理任务库、可重复运行、可调速、可查看运行历史
  - 痛点：任务散落在文件系统、缺少批量/标签/最近记录
- **P3：技术/自动化用户（“脚本编排与调试”）**
  - 目标：脚本模板、API 文档、运行日志、错误定位、变量/参数化
  - 痛点：编辑器能力弱、缺乏控制台、缺少示例
- **P4：测试/QA（“回归复现与对比”）**
  - 目标：精准时序、可视化轨迹、版本化记录、失败提示
  - 痛点：缺少回放日志、缺少“回放前检查/确认”

## 4. 信息架构与导航重构（主界面突出核心能力）
- **导航建议（桌面优先）**：左侧侧边栏 + 顶部状态条
  - **仪表盘**（快速开始、最近任务、运行状态、停止运行提示）
  - **录制**（录制配置、实时状态、暂停/继续、结束总结）
  - **回放**（选择任务、参数、运行队列、进度/日志）
  - **任务库**（.trc/.lua 列表、标签、搜索、收藏、批量操作）
  - **脚本**（编辑器、模板、API 参考、运行控制台）
  - **转换/分析**（轨迹抽稀、预览、导出、统计图表）
  - **设置**（热键、输入屏蔽策略、字体/语言、主题、无障碍）
  - **帮助**（新手教程、风险提示、常见问题）
- **全局状态条**：当前模式（录制/回放/空闲）、文件名、倍速、BlockInput 状态、CPU/帧率提示（可选）、一键停止运行。

## 5. UI 设计规范（Design System 文档）
- **色彩系统**：
  - Light/Dark 两套主题 + 高对比模式
  - 语义色：Primary/Success/Warning/Danger/Info + Neutral 灰阶
  - 对比度：文本≥4.5:1，关键按钮/标签在两主题一致
- **字体规范（中文优先）**：
  - 优先：思源黑体/Noto Sans SC；回退：微软雅黑；等宽：JetBrains Mono + 中文回退
  - 字号梯度：12/14/16/20/24；行高 1.4–1.6
- **图标风格**：线性图标（1.5px/2px）+ 统一圆角；危险操作用填充强调
- **组件库**：
  - 导航：Sidebar、Tabs、Breadcrumb
  - 表单：TextField、FilePicker、Select、Slider、Switch、HotkeyPicker
  - 反馈：Toast、InlineError、Modal、ConfirmSheet、Progress、EmptyState
  - 数据：Table（排序/筛选/分页）、Timeline、LogViewer、MiniChart
- **间距与布局**：4px 基准；页面边距 24；卡片间距 16；控件高度 32/36
- **动效规范**：
  - 过渡：150–220ms，缓动 ease-out
  - 关键反馈：开始录制/开始回放/停止运行明显状态切换
- **可访问性（WCAG 2.1）**：
  - 键盘可达：Tab 顺序、可见焦点环、快捷键提示
  - 字体放大：125%/150% 布局不崩
  - 颜色非唯一表达：同时提供图标/文本

## 6. 各功能模块界面重设计（页面级方案）
### 6.1 主界面（仪表盘）
- “快速开始”引导卡：1) 选择任务文件夹 2) 录制 3) 回放
- 最近任务列表（表格/卡片）：名称、类型(.trc/.lua)、时长、最后运行、快捷操作（运行/编辑/打开位置）
- 风险提示与安全：BlockInput 说明、停止运行指引、管理员权限提示

### 6.2 录制页
- 顶部：录制状态（计时/事件数/输入源开关）+ 大按钮（开始/暂停/继续/停止）
- 录制设置：
  - 捕获项：鼠标移动/点击/滚轮/键盘（可开关）
  - 悬浮提示：位置/透明度/是否显示
  - 输出：命名规则、保存位置、自动保存/提示覆盖
- 停止后总结页：时长、事件统计、可一键“立即回放/导出脚本/打开任务库”

### 6.3 回放页
- 任务选择：从任务库选 or 直接选择文件
- 参数区：倍速、重复次数、BlockInput（带二次确认）、拟人化开关（若启用脚本则展示）
- 运行区：进度条、剩余时间估计、实时日志（注入失败/权限不足/文件错误）
- 控制：开始/暂停/停止/停止运行（视觉层级清晰）

### 6.4 任务库页（数据展示重点）
- 表格：搜索、标签、筛选（类型/最近/收藏）、排序（最近运行/时长）
- 批量操作：运行、导出、重命名、删除（危险操作确认）
- 详情侧栏：统计（点击次数、键盘次数、轨迹长度）、备注、快捷键

### 6.5 脚本页（Lua）
- 布局：左侧文件树/模板库，右侧编辑器（语法高亮/行号/折叠）
- 运行控制台：输出、错误定位、上次运行结果
- API 面板：内置函数说明 + 示例（完全中文）
- 模板：常见动作（移动+点击、循环、等待、组合任务）

### 6.6 转换/分析页（可视化与“更可信”）
- 轨迹预览：二维画布显示路径/关键点、容差滑块、关键点数量预估
- 事件时间线：按类型颜色区分（move/click/key/wheel）
- 导出：导出 Lua、导出统计报表（可选）

### 6.7 设置页
- 热键：停止运行（固定/可配置策略）、开始录制、开始回放
- 权限：BlockInput 启用条件与提示
- 外观：主题、字号、中文字体选择
- 无障碍：高对比、键盘导航提示、减少动效

## 7. 响应式与移动端适配策略
- **定义“移动端”范围**：优先覆盖小屏笔记本/平板（窗口宽度 768–1024）与触控场景。
- **布局断点**：≥1200 三栏；768–1199 两栏；<768 单栏+底部主操作条。
- **触控优化**：最小点击热区 44px、滑块增大、表格切卡片视图。

## 8. 交互原型与交付物（你要求的完整链路）
- **流程图**：任务流（录制→总结→回放→历史）与脚本流（编辑→运行→调试）。
- **线框图**：所有页面的低保真布局 + 关键状态（空/加载中/错误/完成）。
- **高保真稿**：Light/Dark/高对比三套关键页面。
- **动效演示**：录制/回放状态切换、Toast、Modal、侧栏展开（GIF/Lottie 标准）。
- **标注与切图**：
  - 组件尺寸、间距、颜色值、字体规格、图标导出
  - 设计 token（JSON：color/spacing/radius/typography/motion）
- **源文件**：Figma（优先）/Sketch（可选）组件库 + 页面稿。

## 9. 用户测试与可用性评估（多轮迭代）
- 每轮 5–7 人，覆盖 P1–P4
- 任务脚本：
  - 录制并保存一个任务
  - 从任务库运行并调整倍速
  - 在脚本页运行模板并定位错误
- 度量：完成率、用时、错误次数、SUS、主观负荷（NASA-TLX 可选）
- 输出：问题清单→优先级→修复建议→二次验证

## 10. 开发落地（将设计系统映射到现有 ImGui 技术栈）
- 产出“UI 实现映射表”：设计 token → ImGuiStyle/ImFont/颜色常量/组件封装
- 建议建立一层组件封装（Button/Input/Modal/Table/Toast），让 UI 一致且可迭代
- 中文字体：在初始化阶段加载中文字体与 fallback；确保所有文本可显示

## 11. 本阶段我会先交付什么（可执行范围）
- 《现状功能与用户流程梳理》
- 《用户画像与场景》+ 《需求/痛点矩阵》
- 《信息架构与页面清单》
- 《UI 设计规范（Design System v1）》+ Token 表
- 《关键页面线框图（文字版/结构版）》+ 交互说明

确认后，我将按以上结构产出详细文档与每个页面的组件级规格，并给出可直接落到 ImGui 的实现映射（含中文字体与 WCAG 对比度校验清单）。